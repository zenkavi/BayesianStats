---
title: "RL simulation and parameter recovery with Stan"
output: html_notebook
---

Translating Deanizeau et al. (2014) Q-learning example

```{r}
source('/Users/zeynepenkavi/Dropbox/RangelLab/BayesianStats/helpers/demo_QlearningSimulation.R')
```

Generate simulated data

```{r}
sim_data = demo_QlearningSimulation()
```

Learning rate

```{r}
sim_data$simulation$evolution
```

Inverse temperature

```{r}
sim_data$simulation$observation
```

Choices and EV across time

```{r}
df = data.frame(choices = c(sim_data$y), 
                tendency = c(sim_data$y - sim_data$e))
```


```{r}
df %>%
  mutate(trial_n = 1:n()) %>%
  ggplot(aes(x=trial_n))+
  geom_point(aes(y=choices, color="choices"))+
  geom_line(aes(y=tendency, color="p(y=1|theta,phi,m): behavioural tendency"))+
  scale_colour_manual(name="",values=c("choices" = "black", "p(y=1|theta,phi,m): behavioural tendency" = "red"))+
  theme(legend.position = "bottom")
```

Now that you have the data invert it using Stan to get parameters.
